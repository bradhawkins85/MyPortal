# Core application settings
APP_NAME=MyPortal
ENVIRONMENT=development
SESSION_SECRET=change-me
TOTP_ENCRYPTION_KEY=change-me
DB_HOST=localhost
DB_USER=myportal
DB_PASSWORD=strong-password
DB_NAME=myportal
MIGRATION_LOCK_TIMEOUT=60
REDIS_URL=
SESSION_COOKIE_NAME=myportal_session
ALLOWED_ORIGINS=

# SMTP configuration
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_SECURE=true

# External integrations
STOCK_FEED_URL=
SYNCRO_WEBHOOK_URL=
SYNCRO_API_KEY=
# DEPRECATED: Staff verification now uses the SMS Gateway module (sms-gateway)
# Configure the SMS Gateway module via the admin UI instead
VERIFY_WEBHOOK_URL=
VERIFY_API_KEY=
SMS_ENDPOINT=
SMS_AUTH=
PORTAL_URL=http://localhost:8000
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=
AZURE_TENANT_ID=
LICENSES_WEBHOOK_URL=
LICENSES_WEBHOOK_API_KEY=
SHOP_WEBHOOK_URL=
SHOP_WEBHOOK_API_KEY=
M365_ADMIN_CLIENT_ID=
M365_ADMIN_CLIENT_SECRET=

# Operational controls
CRON_TIMEZONE=UTC
ENABLE_CSRF=true
# Enable Strict-Transport-Security (HSTS) header to enforce HTTPS
# Only enable this if your application is served over HTTPS
ENABLE_HSTS=false
# Toggle UI refresh polling. When true, dashboards automatically request
# new data from the server without requiring a manual reload.
ENABLE_AUTO_REFRESH=false
# Prevent caching by proxy servers and CDNs. When true, adds no-cache headers to responses.
# Static files are exempt from this restriction.
DISABLE_CACHING=true
SWAGGER_UI_URL=/docs
OPNFORM_BASE_URL=
FAIL2BAN_LOG_PATH=
SYSTEMD_SERVICE_NAME=myportal
SERVICE_USER=
APP_RESTART_COMMAND=
FORCE_RESTART=0
UVICORN_AUTO_UPDATE_ENABLED=true
UVICORN_AUTO_UPDATE_ATTEMPTS=2
UVICORN_AUTO_UPDATE_RETRY_DELAY=5

# Integration modules (defaults can be overridden via admin UI)
OLLAMA_BASE_URL=http://127.0.0.1:11434
OLLAMA_MODEL=llama3
# Minimum number of matching AI tags required between a ticket and knowledge base article
# for the article to be shown as relevant (default: 1)
AI_TAG_THRESHOLD=1
SMTP_DEFAULT_RECIPIENTS=
TACTICALRMM_BASE_URL=
TACTICALRMM_API_KEY=
TACTICALRMM_VERIFY_SSL=true
NTFY_BASE_URL=https://ntfy.sh
NTFY_TOPIC=
NTFY_AUTH_TOKEN=
UPTIMEKUMA_SHARED_SECRET=
# Xero OAuth2 integration
# To set up Xero integration:
# 1. Create an OAuth2 app at https://developer.xero.com/
# 2. Set the redirect URI in your Xero app to: {PORTAL_URL}/xero/callback
#    (e.g., https://myportal.example.com/xero/callback)
# 3. Set PORTAL_URL, XERO_CLIENT_ID and XERO_CLIENT_SECRET below
# 4. Navigate to /xero/connect as super admin to authorize
# 5. Access token and refresh token are obtained automatically via OAuth2 code flow
# Note: Do NOT manually set refresh_token - it's managed automatically
# Note: PORTAL_URL must be set correctly for OAuth to work
XERO_CLIENT_ID=
XERO_CLIENT_SECRET=
XERO_TENANT_ID=
XERO_COMPANY_NAME=
XERO_DEFAULT_HOURLY_RATE=
XERO_ACCOUNT_CODE=400
XERO_TAX_TYPE=
XERO_LINE_AMOUNT_TYPE=Exclusive
XERO_REFERENCE_PREFIX=Support
XERO_BILLABLE_STATUSES=resolved, closed
XERO_LINE_ITEM_TEMPLATE=Ticket #{ticket_id} - {ticket_subject} - {labour_name}

# ChatGPT MCP integration
CHATGPT_MCP_SHARED_SECRET=
CHATGPT_MCP_ALLOWED_ACTIONS=listTickets,getTicket,createTicketReply,updateTicket
CHATGPT_MCP_MAX_RESULTS=50
CHATGPT_MCP_ALLOW_UPDATES=false
CHATGPT_MCP_ALLOWED_STATUSES=open,pending,in_progress,resolved,closed
CHATGPT_MCP_SYSTEM_USER_ID=

# Call Recordings
# Configure via Admin > Integration Modules or set default path here
CALL_RECORDINGS_PATH=/var/lib/myportal/call_recordings

# Business Continuity Plan Export Settings
# Maximum number of BC plan exports allowed per minute (per user) to prevent abuse
# This rate limit applies to both PDF and DOCX exports. Set to 0 to disable rate limiting.
# Default: 10
EXPORT_MAX_PER_MINUTE=10
# WeasyPrint configuration options (JSON format)
# Controls PDF rendering quality and behavior for BC plan exports.
# Example: {"dpi": 96, "optimize_size": ["fonts"]}
# Available options:
# - dpi: Rendering resolution (default: 96)
# - optimize_size: Array of optimization features (e.g., ["fonts", "images"])
# Leave empty for default settings. See WeasyPrint docs for all options.
WEASYPRINT_OPTIONS=

# Business Continuity Planning (BCP) Module
# Enable or disable the BCP module features (default: true)
BCP_ENABLED=true

# Model Context Protocol (MCP) Server
# Enable the MCP WebSocket server for authorized agent access (default: false)
MCP_ENABLED=false
# Secret token for MCP authentication. Required if MCP_ENABLED is true.
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
MCP_TOKEN=
# Comma-separated list of allowed models (default: users,tickets,change_log)
MCP_ALLOWED_MODELS=users,tickets,change_log
# Enforce read-only operations (default: true)
MCP_READONLY=true
# Maximum requests per minute per connection (default: 60)
MCP_RATE_LIMIT=60

# Plausible Analytics
# Privacy-friendly analytics for email tracking (opens and clicks) and authenticated user pageviews
# Base URL of your Plausible instance (default: https://plausible.io)
PLAUSIBLE_BASE_URL=https://plausible.io
# Your site domain registered in Plausible (e.g., myportal.example.com)
PLAUSIBLE_SITE_DOMAIN=
# API key for sending events to Plausible (optional, configure via admin UI)
PLAUSIBLE_API_KEY=
# Enable tracking of email opens (default: true)
PLAUSIBLE_TRACK_OPENS=true
# Enable tracking of link clicks in emails (default: true)
PLAUSIBLE_TRACK_CLICKS=true
# Send tracking events to Plausible Analytics (default: false, events stored locally)
PLAUSIBLE_SEND_TO_PLAUSIBLE=false
# Enable tracking of authenticated user pageviews (default: false)
# When enabled, sends custom pageview events with hashed user identifiers to Plausible
PLAUSIBLE_TRACK_PAGEVIEWS=false
# Secret pepper for HMAC hashing of user identifiers (REQUIRED for pageview tracking)
# Generate a secure random value: python -c "import secrets; print(secrets.token_urlsafe(32))"
# This ensures user privacy by hashing usernames before sending to Plausible
PLAUSIBLE_PEPPER=
# Send PII (personally identifiable information) to Plausible (default: false)
# ONLY enable this for self-hosted, compliant Plausible instances
# When false (recommended), user identifiers are hashed with HMAC before sending
PLAUSIBLE_SEND_PII=false
