<!DOCTYPE html>
<html>
  <%- include('partials/head', { title: 'Syncro Customers' }) %>
  <body>
    <div class="app-container">
      <%- include('partials/sidebar') %>
      <div class="content">
        <header class="page-header">
          <div class="page-title">
            <p class="page-subtitle">Modern GMP learning</p>
            <h1>Syncro Customers</h1>
            <p class="page-description">Import and reconcile Syncro customer records with your portal data.</p>
          </div>
          <div class="header-actions"></div>
        </header>
        <div class="page-body">
        <p>
          <a href="/admin/syncro/customers<%= showHidden ? '' : '?showHidden=1' %>">
            <%= showHidden ? 'Hide Hidden Customers' : 'Show Hidden Customers' %>
          </a>
        </p>
        <table>
          <thead>
            <tr><th>Name</th><th>Status</th><th>Actions</th></tr>
          </thead>
          <tbody>
            <% customers.forEach(function(c){
                 var imported = importedIds.includes(String(c.id));
                 var hidden = hiddenIds.includes(String(c.id));
                 var name = c.business_name || [c.first_name, c.last_name].filter(Boolean).join(' ');
            %>
            <tr>
              <td><%= name || ('Customer ' + c.id) %></td>
              <td><%= hidden ? 'Hidden' : (imported ? 'Imported' : 'Not Imported') %></td>
              <td>
                <form method="post" action="/admin/syncro/import" style="display:inline">
                  <input type="hidden" name="customerId" value="<%= c.id %>">
                  <input type="hidden" name="showHidden" value="<%= showHidden ? 1 : 0 %>">
                  <button type="submit"><%= imported ? 'Update' : 'Import' %></button>
                </form>
                <% if (hidden) { %>
                <form method="post" action="/admin/syncro/unhide" style="display:inline">
                  <input type="hidden" name="customerId" value="<%= c.id %>">
                  <input type="hidden" name="showHidden" value="<%= showHidden ? 1 : 0 %>">
                  <button type="submit">Unhide</button>
                </form>
                <% } else { %>
                <form method="post" action="/admin/syncro/hide" style="display:inline">
                  <input type="hidden" name="customerId" value="<%= c.id %>">
                  <input type="hidden" name="showHidden" value="<%= showHidden ? 1 : 0 %>">
                  <button type="submit">Hide</button>
                </form>
                <% } %>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table>
        <p><a href="/admin">Back</a></p>
      </div>
        </div>
    </div>
  </body>
</html>
