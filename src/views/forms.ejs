<!DOCTYPE html>
<html>
  <%- include('partials/head', { title: 'Forms' }) %>
<body>
  <div class="app-container">
    <%- include('partials/sidebar') %>
    <div class="content">
      <header class="page-header">
        <div class="page-title">
          <p class="page-subtitle">Modern GMP learning</p>
          <h1>Forms</h1>
          <p class="page-description">Complete assigned GMP forms and keep every process documented.</p>
        </div>
        <div class="header-actions"></div>
      </header>
      <div class="page-body">
      <% if (forms.length > 0) { %>
        <div class="forms-menu">
          <% forms.forEach(function(f, idx){ %>
            <button data-open-form data-form-url="<%= f.iframeUrl %>" class="<%= idx === 0 ? 'active' : '' %>"><%= f.name %></button>
          <% }); %>
        </div>
        <iframe
          id="form-frame"
          class="form-frame"
          src="<%= forms[0].iframeUrl %>"
          loading="lazy"
          title="Selected form"
          allow="publickey-credentials-get *; publickey-credentials-create *"
        ></iframe>
      <% } else { %>
        <p>No forms available.</p>
      <% } %>
    </div>
      </div>
  </div>
  <script>
    function showForm(formUrl, btn) {
      const frame = document.getElementById('form-frame');
      if (frame && formUrl) {
        frame.src = formUrl;
      }
      document.querySelectorAll('.forms-menu button').forEach(b => b.classList.remove('active'));
      if (btn) btn.classList.add('active');
    }
  </script>
</body>
</html>
