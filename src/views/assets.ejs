<!DOCTYPE html>
<html>
  <%- include('partials/head', { title: 'Assets' }) %>
<body>
  <div class="app-container">
    <%- include('partials/sidebar') %>
    <div class="content">
      <h1>Assets</h1>
      <section>
        <h2>Company Assets</h2>
        <table>
          <thead>
            <tr><th>Name</th><th>Type</th><th>Serial Number</th><th>Status</th><% if (isSuperAdmin) { %><th>Actions</th><% } %></tr>
          </thead>
          <tbody>
          <% assets.forEach(function(a) { %>
            <tr>
              <td><%= a.name %></td>
              <td><%= a.type %></td>
              <td><%= a.serial_number %></td>
              <td><%= a.status %></td>
              <% if (isSuperAdmin) { %>
              <td><button class="delete-btn" data-asset-id="<%= a.id %>">Delete</button></td>
              <% } %>
            </tr>
          <% }); %>
          </tbody>
        </table>
      </section>
    </div>
  </div>
<% if (isSuperAdmin) { %>
<script>
  document.querySelectorAll('.delete-btn').forEach(function(btn) {
    btn.addEventListener('click', async function() {
      if (!confirm('Delete asset?')) return;
      const res = await fetch(`/assets/${this.dataset.assetId}`, { method: 'DELETE' });
      if (res.ok) {
        location.reload();
      } else {
        alert('Failed to delete asset');
      }
    });
  });
</script>
<% } %>
</body>
</html>
